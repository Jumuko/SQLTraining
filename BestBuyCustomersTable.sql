/**********************************************************************************************************************
DEVELOPER: JOHN O. UMUKORO
DATE CREATED: 2024-10-8
CODE VERSION: 1.0
DESCRIPTION: THIS CODE CREATES AND INSERTS RECORDS INTO BEST BUY INFORMATION TABLES, PROVIDES INFORMATION ABOUT BEST BUY 
			 CUSTOMERS, PRODUCTS PURCHASED, AND THIER ORDER ID.

**********************************************************************************************************************/

--1:CREATING A BEST_BUY CUSTOMERS  TABLE
CREATE TABLE BEST_BUY_CUSTOMERS
( 
 CUSTOMER_ID INT NOT NULL,
 FIRST_NAME VARCHAR(50) NULL,
 LAST_NAME VARCHAR(50) NULL,
 AGE INT NOT NULL,
COUNTRY VARCHAR(50) NULL
);


--2:LOAD DATA TO THE BEST_BUY_CUSTOMERS TABLE
INSERT INTO BEST_BUY_CUSTOMERS
(CUSTOMER_ID, FIRST_NAME, LAST_NAME, AGE, COUNTRY)
VALUES (1, 'JOHN', 'DOE', 31, 'USA'),
(2, 'ROBERT', 'LUNA', 22, 'USA'),
(3, 'DAVID', 'ROBINSON', 22, 'UK'),
(4, 'JOHN', 'REINHARDT', 25, 'UK'),
(5, 'BETTY', 'DOE', 28, 'UAE')

 
--2:CREATING AN ORDER TABLE

CREATE TABLE BEST_BUY_ORDERS
(
   ORDER_ID INT NOT NULL,
   ITEM VARCHAR(50) NULL,
   AMOUNT MONEY,
   CUSTOMER_ID INT NOT NULL
);


--2:LOAD DATA TO THE ( 1, 'KEYBOARD', 400,4), TABLE
INSERT INTO BEST_BUY_ORDERS
(ORDER_ID, ITEM, AMOUNT, CUSTOMER_ID)
VALUES ( 1, 'KEYBOARD', 400,4),
( 2, 'MOUSE', 300,4),
( 3, 'MONITOR', 12000,3),
( 4, 'KEYBOARD', 400,1),
( 5, 'MOUSEPAD', 250,2)


--2:CREATING A BEST_BUY_PRODUCTS TABLE

CREATE TABLE BEST_BUY_PRODUCTS
(
   PRODUCT_ID INT NOT NULL,
   PRODUCT_NUMBER VARCHAR(50) NULL,
   AMOUNT MONEY,
   CUSTOMER_ID INT NOT NULL
);


--2:LOAD DATA TO THE ( 1, 'KEYBOARD', 400,4), TABLE
INSERT INTO BEST_BUY_PRODUCTS
(PRODUCT_ID, PRODUCT_NUMBER, AMOUNT, CUSTOMER_ID)
VALUES ( 1, 'KEYBOARD', 400,5),
( 2, 'HEADPHONE', 300,4),
( 3, 'LAPTOP', 12000,3),
( 4, 'PEN', 400,1),
( 5, 'MOUSEPAD', 250,2);



--CHECK RECORDS IN NEWLY CREATED TABLES
SELECT *
FROM BEST_BUY_CUSTOMERS

SELECT *
FROM BEST_BUY_PRODUCTS

SELECT *
FROM BEST_BUY_ORDERS


--JOIN TABLES TO VIEW ALL RECORDS
SELECT DISTINCT *
FROM BEST_BUY_CUSTOMERS A
JOIN BEST_BUY_PRODUCTS B
ON A.CUSTOMER_ID=B.CUSTOMER_ID
JOIN BEST_BUY_ORDERS C 
ON B.CUSTOMER_ID=C.CUSTOMER_ID

--QUESTION 1: WRITE A QUERY THAT SHOWS CUSTOMER WHO BOUGHT ITEM MOUSE
SELECT	
	A.FIRST_NAME,
	A.LAST_NAME,
	C.ITEM
FROM BEST_BUY_CUSTOMERS A
	JOIN BEST_BUY_PRODUCTS B
	ON A.CUSTOMER_ID=B.CUSTOMER_ID
	JOIN BEST_BUY_ORDERS C 
	ON B.CUSTOMER_ID=C.CUSTOMER_ID
WHERE ITEM = 'MOUSE'
GROUP BY A.FIRST_NAME,A.LAST_NAME,C.ITEM

--QUESTION 2: SHOW ME THE CUSTOMER INFO AND THE ITEM THAT THEY ORDER, THE PRODUCT BUT ONLY SHOW THE PRODUCT FOR PEN
SELECT DISTINCT 
	A.CUSTOMER_ID,
	A.FIRST_NAME,
	A.LAST_NAME,
	A.AGE,A.COUNTRY,
	C.ITEM,C.AMOUNT,
	B.PRODUCT_NUMBER
FROM BEST_BUY_CUSTOMERS A
	JOIN BEST_BUY_PRODUCTS B
	ON A.CUSTOMER_ID=B.CUSTOMER_ID
	JOIN BEST_BUY_ORDERS C 
	ON B.CUSTOMER_ID=C.CUSTOMER_ID
WHERE PRODUCT_NUMBER = 'PEN'
